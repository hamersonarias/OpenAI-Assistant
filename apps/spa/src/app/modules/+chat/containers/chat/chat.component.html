<ai-chat-header (click)="clearChat()"></ai-chat-header>

<mat-card class="card">
  <mat-card-content>
    @if (threadId()) {
      <div class="close">
        <button mat-icon-button (click)="clearChat()">
          <mat-icon>close</mat-icon>
        </button>
      </div>

      <div class="messages">
        @for (message of messages; track message) {
        <div
          markdown
          class="message"
          [ngClass]="'message-' + message.role"
          [data]="message.content"
          #item
        ></div>
        } @empty {
        <div>Start the conversation...</div>
        }
        <ai-message-typing [isLoading]="isLoading"></ai-message-typing>
      </div>

      <mat-form-field appearance="fill">
        <mat-label>
          Your message...
        </mat-label>
        <input
          matInput
          [(ngModel)]="content"
          (keydown.enter)="sendMessage(content)"
          [disabled]="isLoading"
        />
        <button
          mat-icon-button
          matSuffix
          (click)="sendMessage(content)"
          [disabled]="isLoading"
        >
          <mat-icon>send</mat-icon>
        </button>
      </mat-form-field>
    } @else {
      <ai-chat-form (initMessage$)="sendMessage($event)"></ai-chat-form>
    }
  </mat-card-content>
</mat-card>
